<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego de Sumas y Restas</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f0f0f0;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
  }

  .contenedor-juego {
    max-width: 500px;
    width: 100%;
    margin: 30px auto;
    padding: 30px;
    border: 3px solid #4CAF50;
    border-radius: 20px;
    background: linear-gradient(180deg, #f9fff9, #e9ffe9);
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  h2 {
    font-size: 28px;
    color: #2e7d32;
    margin-bottom: 10px;
  }

  .campo {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
  }

  .checkbox {
    flex-direction: row;
    justify-content: center;
    align-items: center;
    gap: 10px;
  }

  select {
    font-size: 20px;
    padding: 6px 8px;
    border-radius: 6px;
    border: 1px solid #aaa;
  }

  .botones {
    display: flex;
    justify-content: center;
    gap: 15px;
  }

  button {
    font-size: 20px;
    padding: 10px 16px;
    border-radius: 8px;
    border: none;
    background-color: #4CAF50;
    color: white;
    cursor: pointer;
    transition: background 0.3s;
  }

  button:hover { background-color: #45a049; }

  #contador {
    font-size: 22px;
    font-weight: bold;
    color: #2e7d32;
  }

  .linea-horizontal {
    height: 2px;
    background-color: #333;
    margin: 10px 0;
  }

  /* Problemas y resultados */
  .linea {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: nowrap;
    margin-bottom: 15px;
  }

  .columna {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
  }

  .celda, input {
    width: 45px;
    height: 45px;
    font-size: 24px;
    text-align: center;
    border-radius: 8px;
    border: 1px solid #aaa;
    box-sizing: border-box;
  }

  input[type="text"].resultado {
    border: 2px solid #4CAF50;
    font-weight: bold;
  }

  .correct { background-color: #b2ffb2; } 
  .wrong { background-color: #ffb2b2; }

  @media (max-width: 600px) {
    .celda, input { width: 40px; height: 40px; font-size: 20px; }
    select, button { font-size: 18px; }
    .linea { gap: 6px; }
    .columna { gap: 3px; }
  }
</style>
</head>
<body>
  <button class="btn-inicio" onclick="irInicioOAtras()">â¬… Inicio</button>


<div class="contenedor-juego">
  <h2>ðŸ§® Juego de Sumas y Restas</h2>

  <div class="campo">
    <label>Tipo de operaciÃ³n:</label>
    <select id="tipoOperacion">
      <option value="ambas">Sumas y Restas</option>
      <option value="suma">Solo Sumas</option>
      <option value="resta">Solo Restas</option>
    </select>
  </div>

  <div class="campo">
    <label>NÃºmero de cifras:</label>
    <select id="numCifras">
      <option value="1">1 cifra</option>
      <option value="2">2 cifras</option>
      <option value="3">3 cifras</option>
    </select>
  </div>

  <div class="campo checkbox">
    <input type="checkbox" id="conLlevadas">
    <label for="conLlevadas">Con llevadas</label>
  </div>

  <div class="botones">
    <button id="btnComenzar">Comenzar juego</button>
    <button id="btnNueva">Probar otra</button>
  </div>

  <hr class="linea-horizontal">
  <div id="lineas" class="linea"></div>
  <div class="linea-horizontal"></div>
  <div id="contador">Aciertos: 0</div>
</div>

<script>
let num1, num2, operador, resultado, aciertos=0;

function splitDigits(num,length){ return num.toString().padStart(length,'0').split('').map(Number); }

function generarNumeros(cifras, permitirLlevadas, operador){
    let a=[], b=[];
    for(let i=0;i<cifras;i++){
        a.push(Math.floor(Math.random()*10));
        b.push(Math.floor(Math.random()*10));
    }

    if(!permitirLlevadas){
        if(operador==="+"){
            for(let i=cifras-1;i>=0;i--){
                if(a[i]+b[i]>9) b[i]=9-a[i];
            }
        } else if(operador==="-"){
            for(let i=cifras-1;i>=0;i--){
                if(a[i]<b[i]) b[i]=a[i];
            }
        }
    }

    let num1=parseInt(a.join(''));
    let num2=parseInt(b.join(''));
    if(operador==="-" && num1<num2) [num1,num2]=[num2,num1];
    return [num1,num2];
}

function nuevaPregunta(){
  const tipo=document.getElementById("tipoOperacion").value;
  const cifras=parseInt(document.getElementById("numCifras").value);
  const conLlevadas=document.getElementById("conLlevadas").checked;

  operador=tipo==="suma"?"+":tipo==="resta"? "-": Math.random()<0.5?"+":"-";

  [num1,num2]=generarNumeros(cifras, conLlevadas, operador);
  resultado=operador==="+"? num1+num2 : num1-num2;

  renderProblem();
}

function renderProblem(){
  const lineasDiv=document.getElementById('lineas');
  lineasDiv.innerHTML='';

  const maxCifras=Math.max(num1.toString().length,num2.toString().length,resultado.toString().length);
  const cifras1=splitDigits(num1,maxCifras);
  const cifras2=splitDigits(num2,maxCifras);
  const resDigits=splitDigits(resultado,maxCifras);
  const resultadoInputs=[];

  for(let i=0;i<maxCifras;i++){
    const col=document.createElement('div'); 
    col.className='columna';

    // Llevar (opcional)
    if(i<maxCifras-1){
      const carry=document.createElement('input'); carry.type='text'; carry.maxLength=1; carry.className='carry';
      col.appendChild(carry);
    } else {
      const carryDiv=document.createElement('div'); carryDiv.className='celda'; col.appendChild(carryDiv);
    }

    // Operando superior
    const sup=document.createElement('div'); sup.className='celda'; sup.textContent=cifras1[i]; col.appendChild(sup);

    // Operando inferior
    const inf=document.createElement('div'); inf.className='celda'; 
    if(i===0) inf.textContent=operador+cifras2[i]; 
    else inf.textContent=cifras2[i];
    col.appendChild(inf);

    // Resultado
    const res=document.createElement('input'); res.type='text'; res.maxLength=1; res.className='resultado';
    res.addEventListener('input',()=>checkResult(resultadoInputs,resDigits));
    col.appendChild(res);
    resultadoInputs.push(res);

    lineasDiv.appendChild(col);
  }
}

function checkResult(inputs,resDigits){
  let correcto=true;
  inputs.forEach((input,i)=>{
    if(input.value===''){ input.classList.remove('correct','wrong'); correcto=false; }
    else if(parseInt(input.value)===resDigits[i]){ input.classList.add('correct'); input.classList.remove('wrong'); }
    else{ input.classList.add('wrong'); input.classList.remove('correct'); correcto=false; }
  });
  if(correcto){ aciertos++; document.getElementById('contador').textContent=`Aciertos: ${aciertos}`; setTimeout(nuevaPregunta,500); }
}

document.getElementById('btnComenzar').addEventListener('click',nuevaPregunta);
document.getElementById('btnNueva').addEventListener('click',nuevaPregunta);
</script>

</body>
</html>

