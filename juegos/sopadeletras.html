<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Sopa de Letras</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
#sopa{
  display:grid;
  grid-template-columns: repeat(10, 1fr);
  gap:4px;
  max-width:320px;
  margin:20px auto;
}

.celda{
  width:30px;
  height:30px;
  border:1px solid #333;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  cursor:pointer;
  user-select:none;
}

.celda.seleccion{
  background:#ffd54f;
}

.celda.encontrada{
  background:#81c784;
  color:#fff;
}

.encontrada-palabra{
  text-decoration:line-through;
  color:green;
  font-weight:bold;
}
</style>

</head>
<body>

<h1>Sopa de Letras</h1>

<div id="panel">
  <button onclick="empezar()">Empezar juego</button>
</div>

<div id="contenedor">
  <div id="sopa"></div>
</div>

<div id="lista"></div>

<script>
let contador = 0;
const PALABRAS_POR_PARTIDA = 8;
const TAM=10;
let grid=[];
let palabrasObjetivo=[];
let seleccion=[];
let seleccionando=false;
let direccion=null;

/* ===== BANCOS DE PALABRAS ===== */
const bancoPalabras = [
  "ELEFANTE","FLAMENCO","PINGUINO","RINOCERONTE",
  "CAMELLO","CANGURO","HIPOPOTAMO","COCODRILO",
  "GATO","PERRO","PEZ","RATON","LEON","TIGRE",
  "OSO","ZORRO","JIRAFA","MONO","LORO",
  "AMIGOS","COLE","COMIDA","LIBRO","COCHE",
  "EMMA","ALBA","HUGO", "AGUACATE","GABI",
  "JUGAR","PATINAR","TELAS","SALTAR","ABUELOS",
  "ROMERO","FELIZ","TRISTE","JAMON","AGUA"
  "ARBOL","RECREO",
];

/* ===== EMPEZAR ===== */
function empezar(){
  generarJuego(bancoPalabras);
}

function generarJuego(palabras){
  grid=Array.from({length:TAM},()=>Array(TAM).fill(""));
  palabrasObjetivo=[];

  palabras.sort(()=>Math.random()-0.5);

  for(let p of palabras){
  if(contador >= PALABRAS_POR_PARTIDA) break;
  if(colocarPalabra(p)){
      palabrasObjetivo.push(p);
      contador++;
    }
  }


  // Rellenar huecos
  for(let f=0;f<TAM;f++)
    for(let c=0;c<TAM;c++)
      if(grid[f][c]==="")
        grid[f][c]=String.fromCharCode(65+Math.floor(Math.random()*26));

  dibujar();
  mostrarLista();
}

/* ===== COLOCAR PALABRA ===== */
function colocarPalabra(p){
  for(let i=0;i<100;i++){
    const h=Math.random()<0.5;
    let f=Math.floor(Math.random()*TAM);
    let c=Math.floor(Math.random()*TAM);
    let ok=true;

    if(h && c+p.length<=TAM){
      for(let x=0;x<p.length;x++)
        if(grid[f][c+x] && grid[f][c+x]!==p[x]) ok=false;
      if(ok){
        for(let x=0;x<p.length;x++) grid[f][c+x]=p[x];
        return true;
      }
    }

    if(!h && f+p.length<=TAM){
      for(let x=0;x<p.length;x++)
        if(grid[f+x][c] && grid[f+x][c]!==p[x]) ok=false;
      if(ok){
        for(let x=0;x<p.length;x++) grid[f+x][c]=p[x];
        return true;
      }
    }
  }
  return false;
}

/* ===== DIBUJAR ===== */
function dibujar(){
  const s=document.getElementById("sopa");
  s.innerHTML="";
  for(let f=0;f<TAM;f++){
    for(let c=0;c<TAM;c++){
      const d=document.createElement("div");
      d.className="celda";
      d.textContent=grid[f][c];
      d.dataset.f=f;
      d.dataset.c=c;

      d.onmousedown=inicio;
      d.onmouseenter=arrastrar;
      d.ontouchstart=inicio;
      d.ontouchmove=arrastrarTouch;

      s.appendChild(d);
    }
  }
}

document.addEventListener("mouseup",fin);
document.addEventListener("touchend",fin);

/* ===== SELECCIÓN ===== */
function inicio(e){
  e.preventDefault();
  limpiarSeleccion();
  seleccionando=true;
  direccion=null;
  marcar(this);
}

function arrastrar(){
  if(seleccionando) marcar(this);
}

function arrastrarTouch(e){
  const t=e.touches[0];
  const el=document.elementFromPoint(t.clientX,t.clientY);
  if(el && el.classList.contains("celda")) marcar(el);
}

function fin(){
  if(!seleccionando) return;
  seleccionando=false;
  comprobar();
}

function marcar(el){
  const f=+el.dataset.f,c=+el.dataset.c;
  if(seleccion.some(x=>x.f===f && x.c===c)) return;

  if(seleccion.length){
    const o=seleccion[0];
    if(!direccion){
      if(f===o.f) direccion="H";
      else if(c===o.c) direccion="V";
      else return;
    }
    if(direccion==="H" && f!==o.f) return;
    if(direccion==="V" && c!==o.c) return;
  }

  el.classList.add("seleccion");
  seleccion.push({f,c,el});
}

function comprobar(){
  const palabra=seleccion.map(x=>x.el.textContent).join("");
  if(palabrasObjetivo.includes(palabra)){
    seleccion.forEach(x=>{
      x.el.classList.remove("seleccion");
      x.el.classList.add("encontrada");
    });
    marcarPalabraEncontrada(palabra);
  }else limpiarSeleccion();
  seleccion=[];
}

function limpiarSeleccion(){
  document.querySelectorAll(".seleccion").forEach(x=>x.classList.remove("seleccion"));
}

/* ===== LISTA ===== */
function mostrarLista(){
  document.getElementById("lista").innerHTML=
    "<p><b>Busca:</b> "+
    palabrasObjetivo.map(p=>`<span id="p_${p}">${p}</span>`).join(" · ")+
    "</p>";
}

function marcarPalabraEncontrada(p){
  const el=document.getElementById("p_"+p);
  if(el) el.classList.add("encontrada-palabra");
}
</script>


</body>
</html>






